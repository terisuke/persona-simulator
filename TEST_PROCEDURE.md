# å®Ÿé‹ç”¨æº–å‚™ç¢ºèªæ‰‹é †

## æ¦‚è¦

Stage1 CLI ã¨ Stage2 Streamlit UI ãŒå®Ÿé‹ç”¨ã«è€ãˆã‚‰ã‚Œã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®æ‰‹é †æ›¸ã§ã™ã€‚

## å‰ææ¡ä»¶

- `.streamlit/secrets.toml` ã« `GROK_API_KEY` ã¨ `X_BEARER_TOKEN` ãŒè¨­å®šæ¸ˆã¿
- ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿: `pip install -r requirements.txt`

---

## ãƒ†ã‚¹ãƒˆ1: CLI ã§å°è¦æ¨¡ãƒªã‚¹ãƒˆã‚’å‡¦ç†

### ç›®çš„

- ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆå¾…æ©ŸãŒ `.cache/ingest.log` ã«è¨˜éŒ²ã•ã‚Œã‚‹ã“ã¨
- `fetched_at` ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹ã“ã¨

### æ‰‹é †

#### 1.1 ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’ä½œæˆ

```bash
cat > test_accounts.txt << 'EOF'
# Test accounts for rate limit verification
cor_terisuke
elonmusk
sama
ylecun
karpathy
goodfellow_ian
EOF
```

6ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã€ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’å°ã•ãã—ã¦ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆå‹•ä½œã‚’ç¢ºèªã—ã¾ã™ã€‚

#### 1.2 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢

```bash
rm -rf .cache
```

#### 1.3 CLI ã‚’å®Ÿè¡Œï¼ˆãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’å°ã•ãè¨­å®šï¼‰

```bash
python ingest_accounts.py test_accounts.txt --batch-size 2 --log-level INFO
```

**æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**:
- å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å‡¦ç†çŠ¶æ³ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹
- ãƒãƒƒãƒã”ã¨ã«2ç§’ã®å¾…æ©ŸãŒç™ºç”Ÿ
- X API ã®ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨˜éŒ²ã•ã‚Œã‚‹

#### 1.4 ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª

```bash
# ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆæƒ…å ±ã®ç¢ºèª
grep -i "rate" .cache/ingest.log

# å¾…æ©Ÿãƒ­ã‚°ã®ç¢ºèª
grep -i "å¾…æ©Ÿ\|wait" .cache/ingest.log

# ã‚¨ãƒ©ãƒ¼ã®ç¢ºèª
grep -i "error\|ã‚¨ãƒ©ãƒ¼" .cache/ingest.log
```

**ç¢ºèªé …ç›®**:
- âœ… ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆæ®‹æ•°ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹
- âœ… ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆæŽ¥è¿‘æ™‚ã®å¾…æ©Ÿãƒ­ã‚°ãŒã‚ã‚‹ã‹ï¼ˆæ¡ä»¶æ¬¡ç¬¬ï¼‰
- âœ… ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹

#### 1.5 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª

```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§
ls -lh .cache/*.pkl

# ç‰¹å®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç¢ºèª
python << 'EOF'
import pickle

# cor_terisuke ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’èª­ã¿è¾¼ã¿
with open('.cache/posts_cor_terisuke.pkl', 'rb') as f:
    data = pickle.load(f)

print("=== ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ§‹é€  ===")
print(f"Keys: {data.keys()}")
print(f"\n=== Posts ===")
print(f"æŠ•ç¨¿æ•°: {len(data['posts'])}")
print(f"æœ€åˆã®æŠ•ç¨¿ID: {data['posts'][0]['id']}")
print(f"\n=== Persona ===")
print(f"åå‰: {data['persona'].get('name', 'N/A')}")
print(f"èƒŒæ™¯: {data['persona'].get('background', 'N/A')[:100]}...")
print(f"\n=== Metadata ===")
print(f"å–å¾—æ—¥æ™‚: {data.get('fetched_at', 'ãªã—')}")
EOF
```

**ç¢ºèªé …ç›®**:
- âœ… `posts` ã‚­ãƒ¼ãŒå­˜åœ¨ã—ã€æŠ•ç¨¿ãƒªã‚¹ãƒˆãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹
- âœ… `persona` ã‚­ãƒ¼ãŒå­˜åœ¨ã—ã€ãƒšãƒ«ã‚½ãƒŠæƒ…å ±ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹
- âœ… `fetched_at` ã‚­ãƒ¼ãŒå­˜åœ¨ã—ã€ISOå½¢å¼ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹

#### 1.6 çµæžœã®è¨˜éŒ²

ä»¥ä¸‹ã®æƒ…å ±ã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„:

```
â–¡ å‡¦ç†ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°: ___ / 6
â–¡ æˆåŠŸ: ___ ä»¶
â–¡ å¤±æ•—: ___ ä»¶
â–¡ å‡¦ç†æ™‚é–“: ___ ç§’
â–¡ ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆå¾…æ©Ÿ: ã‚ã‚Š / ãªã—
â–¡ fetched_at è¨˜éŒ²: ã‚ã‚Š / ãªã—
â–¡ ã‚¨ãƒ©ãƒ¼: ã‚ã‚Š / ãªã—
```

---

## ãƒ†ã‚¹ãƒˆ2: Streamlit ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ··åœ¨çŠ¶æ…‹ã‚’ãƒ†ã‚¹ãƒˆ

### ç›®çš„

- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ï¼‹æœªå–å¾—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒæ··åœ¨ã—ãŸçŠ¶æ…‹ã§ã€Œä¸è¶³åˆ†ã‚’å–å¾—ã€ãŒæ­£å¸¸å‹•ä½œã™ã‚‹ã“ã¨
- å„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆæˆåŠŸãƒ»å¤±æ•—ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨

### æ‰‹é †

#### 2.1 éƒ¨åˆ†çš„ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥çŠ¶æ…‹ã‚’ä½œæˆ

```bash
# å‰ã®ãƒ†ã‚¹ãƒˆã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¸€éƒ¨å‰Šé™¤
rm .cache/posts_sama.pkl
rm .cache/posts_ylecun.pkl

# æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸãƒªã‚¹ãƒˆã‚’ä½œæˆ
cat > test_accounts_mixed.txt << 'EOF'
cor_terisuke
elonmusk
sama
ylecun
karpathy
goodfellow_ian
# æ–°è¦è¿½åŠ ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã—ï¼‰
AndrewYNg
lexfridman
EOF
```

**çŠ¶æ…‹**:
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿: cor_terisuke, elonmusk, karpathy, goodfellow_ian (4ä»¶)
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã—: sama, ylecun, AndrewYNg, lexfridman (4ä»¶)

#### 2.2 Streamlit ã‚¢ãƒ—ãƒªã‚’èµ·å‹•

```bash
streamlit run app.py
```

#### 2.3 ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ

1. ã‚µã‚¤ãƒ‰ãƒãƒ¼ã® **ã€ŒðŸ“ ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’é–‹ã
2. `test_accounts_mixed.txt` ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
3. ã€ŒðŸ“¥ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¸€æ‹¬è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

**ç¢ºèªé …ç›®**:
- âœ… 8ä»¶ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹
- âœ… ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹

#### 2.4 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª

ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ¨ªã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç¢ºèª:

```
âœ… cor_terisuke    (ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿)
âœ… elonmusk        (ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿)
â³ sama            (æœªå–å¾—)
â³ ylecun          (æœªå–å¾—)
âœ… karpathy        (ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿)
âœ… goodfellow_ian  (ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿)
â³ AndrewYNg       (æœªå–å¾—)
â³ lexfridman      (æœªå–å¾—)
```

**ç¢ºèªé …ç›®**:
- âœ… ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã« âœ… ãƒžãƒ¼ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… æœªå–å¾—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã« â³ ãƒžãƒ¼ã‚¯ã¾ãŸã¯ç©ºç™½ãŒè¡¨ç¤ºã•ã‚Œã‚‹

#### 2.5 ãƒãƒƒãƒå‡¦ç†ã‚’å®Ÿè¡Œ

1. ã€Œâš¡ ãƒãƒƒãƒå‡¦ç†ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
2. æœªå–å¾—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°ã‚’ç¢ºèªï¼ˆ4ä»¶ã®ã¯ãšï¼‰
3. ã€ŒðŸš€ ä¸è¶³åˆ†ã‚’å–å¾—ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

**ç¢ºèªé …ç›®**:
- âœ… é€²æ—ãƒãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… å‡¦ç†ä¸­ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ãƒãƒƒãƒã”ã¨ã®é€²æ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆä¾‹: ã€ŒðŸ”„ ãƒãƒƒãƒå‡¦ç†ä¸­: 1-2 / 4ã€ï¼‰

#### 2.6 å‡¦ç†çµæžœã‚’ç¢ºèª

ãƒãƒƒãƒå‡¦ç†å®Œäº†å¾Œã€ä»¥ä¸‹ã‚’ç¢ºèª:

**ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢**:
- âœ… ã€ŒðŸŽ‰ ãƒãƒƒãƒå‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸï¼ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- âœ… å‡¦ç†çµæžœã®ã‚µãƒžãƒªãƒ¼:
  ```
  âœ… æˆåŠŸ: Xä»¶
  ðŸ“¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨: 4ä»¶
  âŒ å¤±æ•—: Yä»¶
  ```

**ã‚µã‚¤ãƒ‰ãƒãƒ¼**:
- âœ… å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã« âœ… ãƒžãƒ¼ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆå¤±æ•—ãŒãªã‘ã‚Œã°ï¼‰
- âœ… å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ¨ªã«æŠ•ç¨¿æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹

#### 2.7 ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å‹•ä½œç¢ºèª

1. ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§ `cor_terisuke` (ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿) ã‚’é¸æŠž
2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤ºã‚’ç¢ºèª

**ç¢ºèªé …ç›®**:
- âœ… ã€ŒðŸ“¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… APIå‘¼ã³å‡ºã—ãªã—ã§å³åº§ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹
- âœ… ãƒšãƒ«ã‚½ãƒŠæƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹

#### 2.8 æ–°è¦å–å¾—ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å‹•ä½œç¢ºèª

1. ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§ `sama` (æ–°è¦å–å¾—) ã‚’é¸æŠž
2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤ºã‚’ç¢ºèª

**ç¢ºèªé …ç›®**:
- âœ… æŠ•ç¨¿æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ãƒšãƒ«ã‚½ãƒŠæƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… å–å¾—æ–¹æ³•ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆã€ŒðŸ”‘ X API v2ã€ãªã©ï¼‰

#### 2.9 ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ã‚¿ãƒ–ã‚’ãƒ†ã‚¹ãƒˆ

1. ç”»é¢ä¸Šéƒ¨ã®ã€ŒðŸ“Š ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ã€ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€è¦§ã‚’ç¢ºèª

**ç¢ºèªé …ç›®**:
- âœ… å…¨8ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ—ã«ã€Œã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã€ã€Œå–å¾—æ¸ˆã¿ã€ãªã©ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… æŠ•ç¨¿æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹

#### 2.10 å€‹åˆ¥å†å–å¾—ã‚’ãƒ†ã‚¹ãƒˆ

1. ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§ `cor_terisuke` ã®æ¨ªã® ðŸ”„ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. å†å–å¾—ã®å‹•ä½œã‚’ç¢ºèª

**ç¢ºèªé …ç›®**:
- âœ… ã€ŒðŸ”„ å†å–å¾—ä¸­...ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… å†å–å¾—ãŒå®Œäº†ã™ã‚‹
- âœ… ã€Œâœ… å†å–å¾—å®Œäº†ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ›´æ–°ã•ã‚Œã‚‹

#### 2.11 çµæžœã®è¨˜éŒ²

ä»¥ä¸‹ã®æƒ…å ±ã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„:

```
â–¡ ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰: æˆåŠŸ / å¤±æ•—
â–¡ ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¤œå‡º: æ­£å¸¸ / ç•°å¸¸
â–¡ ãƒãƒƒãƒå‡¦ç†: æˆåŠŸ / å¤±æ•—
  - å‡¦ç†ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°: ___ / 4
  - æˆåŠŸ: ___ ä»¶
  - å¤±æ•—: ___ ä»¶
â–¡ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º: æ­£ç¢º / ä¸æ­£ç¢º
â–¡ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨: æ­£å¸¸ / ç•°å¸¸
â–¡ å€‹åˆ¥å†å–å¾—: æˆåŠŸ / å¤±æ•—
â–¡ UIã®å¿œç­”æ€§: è‰¯å¥½ / å•é¡Œã‚ã‚Š
```

---

## ãƒ†ã‚¹ãƒˆ3: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ç¢ºèª

### 3.1 ç„¡åŠ¹ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆåã®ãƒ†ã‚¹ãƒˆ

```bash
cat > test_invalid.txt << 'EOF'
cor_terisuke
invalid_account_xyz123456789
elonmusk
EOF

python ingest_accounts.py test_invalid.txt
```

**ç¢ºèªé …ç›®**:
- âœ… ç„¡åŠ¹ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹
- âœ… ä»–ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯æ­£å¸¸ã«å‡¦ç†ã•ã‚Œã‚‹
- âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒåˆ†ã‹ã‚Šã‚„ã™ã„

### 3.2 API ã‚­ãƒ¼ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆ

```bash
# ä¸€æ™‚çš„ã«ç’°å¢ƒå¤‰æ•°ã‚’ã‚¯ãƒªã‚¢
unset GROK_API_KEY
python ingest_accounts.py test_accounts.txt
```

**ç¢ºèªé …ç›®**:
- âœ… åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… secrets.toml ã®è¨­å®šã‚’ä¿ƒã™ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

## ãƒ†ã‚¹ãƒˆ4: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ç¢ºèª

### 4.1 å¤§è¦æ¨¡ãƒªã‚¹ãƒˆï¼ˆ20-30ä»¶ï¼‰ã®ãƒ†ã‚¹ãƒˆ

```bash
# 20ä»¶ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’ä½œæˆ
cat > test_large.txt << 'EOF'
cor_terisuke
elonmusk
sama
ylecun
karpathy
goodfellow_ian
AndrewYNg
lexfridman
# ... åˆè¨ˆ20-30ä»¶
EOF

# å‡¦ç†æ™‚é–“ã‚’è¨ˆæ¸¬
time python ingest_accounts.py test_large.txt --batch-size 5
```

**ç¢ºèªé …ç›®**:
- âœ… ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆãŒæ­£ã—ãç®¡ç†ã•ã‚Œã‚‹
- âœ… å‡¦ç†æ™‚é–“ãŒå¦¥å½“ï¼ˆ20ä»¶ã§5-10åˆ†ç¨‹åº¦ï¼‰
- âœ… ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå®‰å®šã—ã¦ã„ã‚‹

---

## ç·åˆè©•ä¾¡ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Stage1 CLI

```
â–¡ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãªã—ã§èµ·å‹•ã—ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„
â–¡ ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆãŒè‡ªå‹•æ¤œå‡ºãƒ»å¾…æ©Ÿã•ã‚Œã‚‹
â–¡ fetched_at ãŒæ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹
â–¡ ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã‚‹
â–¡ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ã„å½¢å¼ã§ä¿å­˜ã•ã‚Œã‚‹
â–¡ ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚é©åˆ‡ã«ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã•ã‚Œã‚‹
â–¡ é€²æ—è¡¨ç¤ºãŒåˆ†ã‹ã‚Šã‚„ã™ã„
â–¡ ä¸­æ–­ãƒ»å†é–‹ãŒå¯èƒ½ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¹ã‚­ãƒƒãƒ—ï¼‰
```

### Stage2 Streamlit UI

```
â–¡ ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå‹•ä½œã™ã‚‹
â–¡ ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¤œå‡ºãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
â–¡ ãƒãƒƒãƒå‡¦ç†ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
â–¡ é€²æ—è¡¨ç¤ºãŒåˆ†ã‹ã‚Šã‚„ã™ã„
â–¡ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºãŒæ­£ç¢º
â–¡ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨æ™‚ã« API å‘¼ã³å‡ºã—ãŒãªã„
â–¡ å€‹åˆ¥å†å–å¾—ãŒå‹•ä½œã™ã‚‹
â–¡ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒåˆ†ã‹ã‚Šã‚„ã™ã„
â–¡ UI ã®å¿œç­”æ€§ãŒè‰¯å¥½
â–¡ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ã‚¿ãƒ–ãŒå‹•ä½œã™ã‚‹
```

### çµ±åˆå‹•ä½œ

```
â–¡ CLI ã§ç”Ÿæˆã—ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ UI ãŒèªè­˜ã™ã‚‹
â–¡ UI ã§ç”Ÿæˆã—ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ CLI ãŒèªè­˜ã™ã‚‹
â–¡ æ··åœ¨çŠ¶æ…‹ã§ã‚‚æ­£å¸¸å‹•ä½œã™ã‚‹
â–¡ ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã„
â–¡ ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãŒä¿ãŸã‚Œã‚‹
```

---

## å®Ÿé‹ç”¨ Ready ã®åˆ¤å®šåŸºæº–

ä»¥ä¸‹ã®æ¡ä»¶ã‚’**ã™ã¹ã¦**æº€ãŸã—ãŸå ´åˆã€å®Ÿé‹ç”¨æº–å‚™å®Œäº†ã¨åˆ¤æ–­ã—ã¾ã™:

1. âœ… CLI ã§ 6ä»¶ä»¥ä¸Šã‚’æ­£å¸¸ã«å‡¦ç†ã§ãã‚‹
2. âœ… `.cache/ingest.log` ã«ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆæƒ…å ±ãŒè¨˜éŒ²ã•ã‚Œã‚‹
3. âœ… `fetched_at` ãŒå…¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«è¨˜éŒ²ã•ã‚Œã‚‹
4. âœ… Streamlit ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ··åœ¨çŠ¶æ…‹ã‚’æ­£ã—ãèªè­˜ã™ã‚‹
5. âœ… ãƒãƒƒãƒå‡¦ç†ã§æœªå–å¾—åˆ†ã®ã¿ã‚’å–å¾—ã™ã‚‹
6. âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºãŒæ­£ç¢ºï¼ˆæˆåŠŸãƒ»å¤±æ•—ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
7. âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡
8. âœ… API å‘¼ã³å‡ºã—ãŒæœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨æ™‚ã¯0å›žï¼‰

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ: ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã«é”ã—ãŸ

**å¯¾å‡¦æ³•**:
```bash
# 15åˆ†å¾…æ©Ÿã—ã¦ã‹ã‚‰å†å®Ÿè¡Œ
sleep 900
python ingest_accounts.py test_accounts.txt
```

### å•é¡Œ: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒèªè­˜ã•ã‚Œãªã„

**å¯¾å‡¦æ³•**:
```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ã‚’ç¢ºèª
ls -l .cache/*.pkl

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å†…å®¹ã‚’ç¢ºèª
python -c "import pickle; print(pickle.load(open('.cache/posts_cor_terisuke.pkl', 'rb')).keys())"
```

### å•é¡Œ: Streamlit ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹

**å¯¾å‡¦æ³•**:
```bash
# Streamlit ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¹ã‚¿ãƒ¼ãƒˆ
streamlit cache clear
streamlit run app.py
```

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ãŸã‚‰:

1. å®Ÿéš›ã®æœ¬ç•ªç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªã‚¹ãƒˆï¼ˆ50-100ä»¶ï¼‰ã‚’æº–å‚™
2. CLI ã§äº‹å‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”Ÿæˆ
3. Streamlit ã§åˆ†æžé–‹å§‹
4. è­°è«–ç”Ÿæˆæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

**ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å®Ÿé‹ç”¨æº–å‚™ãŒæ•´ã„ã¾ã—ãŸï¼ðŸŽ‰**
