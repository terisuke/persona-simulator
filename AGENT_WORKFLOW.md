# 🤖 AIエージェント ワークフロー詳細

## 🎯 全体フロー図

```
┌─────────────────────────────────────────────────────────────┐
│                      ユーザー入力                            │
│  - アカウント名: @cor_terisuke                              │
│  - トピック: "最新のAI技術動向"                             │
└────────────────┬────────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────────┐
│        Phase 1: 環境観察（Environment Observation）          │
├─────────────────────────────────────────────────────────────┤
│  🔍 X API v2                                                 │
│     └─ ユーザーID取得: @cor_terisuke → 1245131...          │
│     └─ 最新20件の投稿取得                                   │
│        ✅ "AIの実装について..."                             │
│        ✅ "音楽制作中！"                                     │
│        ✅ "起業して学んだこと..."                           │
└────────────────┬────────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────────┐
│   Phase 2: マルチプラットフォーム調査（Web Enrichment）      │
├─────────────────────────────────────────────────────────────┤
│  🌐 Grok Live Search（自動検索）                             │
│     ┌──────────────────────────────────┐                   │
│     │ LLMが自動生成した検索クエリ:      │                   │
│     │ - "cor_terisuke LinkedIn"        │                   │
│     │ - "cor_terisuke GitHub"          │                   │
│     │ - "cor_terisuke Instagram"       │                   │
│     │ - "cor_terisuke ブログ AI"       │                   │
│     │ - "cor_terisuke 音楽"            │                   │
│     └──────────────────────────────────┘                   │
│                                                              │
│  📊 検索結果:                                                │
│     ✅ LinkedIn: AIエンジニア、CTO                          │
│     ✅ GitHub: Python/TensorFlowプロジェクト多数            │
│     ✅ Instagram: 音楽制作活動                              │
│     ✅ Note: AI技術記事30本                                 │
│     ✅ メディア: 技術カンファレンス登壇                      │
└────────────────┬────────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────────┐
│        Phase 3: データ統合・分析（Data Integration）         │
├─────────────────────────────────────────────────────────────┤
│  📦 統合データ:                                              │
│     - X投稿: 20件                                           │
│     - LinkedIn: プロフィール + 経歴                         │
│     - GitHub: 技術スタック                                  │
│     - Instagram: 趣味・日常                                 │
│     - ブログ: 専門知識・思考                                │
│                                                              │
│  🧮 統計分析:                                                │
│     - センチメント分析                                       │
│     - 口調マーカー検出                                       │
│     - トピック頻度                                           │
└────────────────┬────────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────────┐
│         Phase 4: ペルソナ生成（Persona Generation）         │
├─────────────────────────────────────────────────────────────┤
│  🧠 Grok LLM（grok-4-fast-reasoning）                       │
│                                                              │
│  入力:                                                       │
│     - X投稿 + Web検索結果                                   │
│                                                              │
│  出力:                                                       │
│  {                                                           │
│    "name": "Terisuke - AI Engineer & Music Producer",      │
│    "background": "AIエンジニア、スタートアップCTO、          │
│                   音楽プロデューサー（Instagram確認）",      │
│    "tendencies": [                                           │
│      "機械学習実装（GitHub確認）",                          │
│      "音楽×テクノロジー",                                  │
│      "起業・スタートアップ",                                │
│      "技術記事執筆（Note確認）"                             │
│    ],                                                        │
│    "tone": "カジュアル、感嘆符多用、ユーモア（w）",         │
│    "personality": "経験重視、マルチタレント、実務家"        │
│  }                                                           │
└────────────────┬────────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────────┐
│       Phase 5: 類似投稿検索（Similarity Search）            │
├─────────────────────────────────────────────────────────────┤
│  🔍 sentence-transformers（パラフレーズモデル）              │
│                                                              │
│  入力:                                                       │
│     - トピック: "最新のAI技術動向"                          │
│     - X投稿: 20件                                           │
│                                                              │
│  処理:                                                       │
│     1. トピックをエンベディング化                           │
│     2. 各投稿をエンベディング化                             │
│     3. コサイン類似度計算                                   │
│     4. Top 3を抽出                                          │
│                                                              │
│  出力:                                                       │
│     [1] "AIの実装について..." (類似度: 0.85)               │
│     [2] "機械学習モデルのデプロイ..." (類似度: 0.78)       │
│     [3] "データサイエンスの実務..." (類似度: 0.72)         │
└────────────────┬────────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────────┐
│   Phase 6: 議論生成（Opinion Generation with Live Search） │
├─────────────────────────────────────────────────────────────┤
│  🧠 Grok LLM + 🌐 Live Search（オプション）                 │
│                                                              │
│  入力:                                                       │
│     - ペルソナ情報（マルチプラットフォーム）                │
│     - 関連投稿Top 3                                         │
│     - トピック                                              │
│     - 会話履歴（オプション）                                │
│                                                              │
│  LLMの自律的行動:                                            │
│     1. ペルソナの興味分野を理解                             │
│     2. トピックに関連する検索ワード生成                     │
│        → "AI技術 2025 最新"                                │
│        → "OpenAI GPT-5"                                     │
│     3. Web検索実行（Live Search有効時）                     │
│     4. 検索結果を統合                                       │
│     5. ペルソナの口調で意見生成                             │
│                                                              │
│  出力:                                                       │
│     "最新のAI技術、ヤバいよね！！（Web検索）OpenAIが       │
│     GPT-5を発表したらしいw これは大きな転換点だなぁ。      │
│     経験から言うと[1]、実装面での課題が気になる💪"          │
└────────────────┬────────────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────────────────────────┐
│           Phase 7: 検証・出力（Validation & Output）        │
├─────────────────────────────────────────────────────────────┤
│  ✅ 口調模倣検証:                                            │
│     - 感嘆符: ✓                                             │
│     - 「w」: ✓                                              │
│     - カジュアル語尾: ✓                                     │
│     - 絵文字: ✓                                             │
│     - スコア: 95%                                           │
│                                                              │
│  📊 表示:                                                    │
│     - エージェント機能バッジ                                │
│     - 意見本文                                              │
│     - 引用投稿（リンク付き）                                │
│     - 口調模倣スコア                                        │
│                                                              │
│  💾 状態更新:                                                │
│     - 会話履歴に追加（有効時）                              │
│     - キャッシュに保存                                      │
└─────────────────────────────────────────────────────────────┘
```

## 🔄 継続的対話フロー（会話履歴ON時）

### ターン1: 初回の議論

```
ユーザー: "最新のAI技術動向について"
                ↓
[Phase 1-7 実行]
                ↓
エージェント: "最新のAI技術、ヤバいよね！..."
                ↓
会話履歴に保存: [
    {"role": "user", "content": "最新のAI技術動向について"},
    {"role": "assistant", "content": "最新のAI技術、ヤバいよね！..."}
]
```

### ターン2: 追加質問

```
ユーザー: "さっきのGPT-5について詳しく教えて"
                ↓
会話履歴を参照: [前回の議論内容を読み込み]
                ↓
エージェント: "さっき話したGPT-5だけど、
              実は3つの大きな改善点があってだなぁ..."
                ↓
会話履歴を更新
```

## 🌐 マルチプラットフォーム検索の詳細

### LLMの自律的判断プロセス

```python
# Step 1: アカウント名とX投稿を分析
account = "cor_terisuke"
sample_posts = [
    "AIの実装について...",
    "音楽制作中！",
    "起業して学んだこと..."
]

# Step 2: LLMが自動で検索クエリを生成
# （人間が指定する必要なし！）
LLMの推論 →
    「このユーザーは技術系？ → LinkedIn検索しよう」
    「GitHub活動があるかも → GitHub検索しよう」
    「音楽の話題？ → Instagram/YouTube検索しよう」
    「起業の話題？ → インタビュー記事検索しよう」

# Step 3: 自動生成された検索クエリ
queries = [
    "cor_terisuke LinkedIn AI engineer",
    "cor_terisuke GitHub machine learning",
    "cor_terisuke Instagram music",
    "cor_terisuke interview startup"
]

# Step 4: Web検索実行 & 結果統合
results = grok_live_search(queries)

# Step 5: サマリー生成
summary = """
LinkedInでAIエンジニアとして5年の経験。
GitHubでPython/TensorFlowプロジェクト多数。
Instagramで音楽制作活動を投稿。
スタートアップCTOとしてインタビュー記事掲載。
"""
```

### 検索されるプラットフォーム例

| プラットフォーム       | 検索される情報     | ペルソナへの影響           |
|----------------|---------------|--------------------|
| **LinkedIn**   | 職歴、スキル、学歴   | 背景（職業・専門性）    |
| **GitHub**     | リポジトリ、言語、貢献 | 技術スタック、実装スキル     |
| **Instagram**  | 投稿、ストーリー      | 趣味、日常、ビジュアル      |
| **Note/ブログ**   | 記事、エッセイ       | 思考、専門知識、価値観 |
| **Qiita/Zenn** | 技術記事        | 技術的専門性         |
| **YouTube**    | 動画、チャンネル      | 活動内容、教育活動    |
| **Portfolio**  | 作品集          | 制作物、スキル証明       |
| **メディア**       | インタビュー、記事     | 実績、評判、影響力     |

## 📊 ペルソナ精度の比較

### Before: X投稿のみ（20件）

```json
{
  "name": "Terisuke",
  "background": "AI・テクノロジーに興味がある人",
  "tendencies": ["技術", "学習"],
  "tone": "カジュアル、感嘆符多用",
  "personality": "ポジティブ"
}
```

**問題点**:
- ❌ 職業が不明
- ❌ 専門分野が曖昧
- ❌ 実績が分からない
- ❌ 趣味の詳細が不足

### After: マルチプラットフォーム（X + 8プラットフォーム）

```json
{
  "name": "Terisuke - AI Engineer & Music Producer",
  "background": "AIエンジニア（LinkedIn: 経験5年、Python/TensorFlow専門）。スタートアップCTO。音楽プロデューサーとしても活動中（Instagram: フォロワー2000）。",
  "tendencies": [
    "機械学習の実装・デプロイ（GitHub: 15プロジェクト）",
    "音楽×テクノロジーの融合",
    "起業・スタートアップ経営（インタビュー記事3件）",
    "技術記事執筆・教育（Note: 30記事、Qiita: 20記事）"
  ],
  "tone": "カジュアル、感嘆符多用（！！）、ユーモア（w、ぐぬぬぬ）、絵文字活用",
  "personality": "経験重視の実務家。マルチタレント（AI×音楽）。ポジティブで自己反省的。ユーモア交じりで親しみやすい。"
}
```

**改善点**:
- ✅ 職業が明確: AIエンジニア、CTO、音楽プロデューサー
- ✅ 専門分野が具体的: Python/TensorFlow、5年経験
- ✅ 実績が豊富: 記事50本、登壇、プロジェクト15件
- ✅ 趣味が詳細: 音楽制作、Instagram活動
- ✅ 人物像が立体的: マルチタレント、実務家気質

## 🎯 議論生成への影響

### Before（X投稿のみ）

```
トピック: "最新のAI技術動向"

意見:
AIの技術って進化が早いよなぁw
勉強し続けないと置いていかれるね！
```

**問題**: 
- 抽象的
- 専門性が低い
- 実体験が薄い

### After（マルチプラットフォーム）

```
トピック: "最新のAI技術動向"

意見:
最新のAI技術、ヤバいよね！！（Web検索）OpenAIのGPT-5が
発表されたらしいw CTOとして実装面で気になるのは、
デプロイのコストとレイテンシだなぁ💡

LinkedInの同業者も騒いでたけど、実務では精度よりも
安定性が大事なんだよね[1]。GitHubでも実験中だけど、
ぐぬぬぬ、奥が深い！！✨

音楽制作でもAI使ってるけど（Instagram投稿）、
クリエイティブとエンジニアリングの融合が
これからの鍵だと思うんだ🎵
```

**改善**:
- ✅ 具体的な言及（GPT-5、コスト、レイテンシ）
- ✅ 専門性が高い（CTO視点、デプロイ経験）
- ✅ 実体験が豊富（LinkedInの同業者、GitHub実験）
- ✅ 多面的（AI×音楽の融合）
- ✅ 人間臭い（複数の活動を自然に織り交ぜる）

## 🧠 LLMの自律的推論例

### ケース1: テック系アカウント

```
X投稿: "今日もコード書いてる"

LLMの推論 →
「コード？エンジニアっぽい」
→ LinkedIn検索（職業確認）
→ GitHub検索（技術スタック確認）
→ Qiita検索（記事があるか）

結果: "Python エンジニア、GitHub活動活発"
```

### ケース2: クリエイター系アカウント

```
X投稿: "新作イラスト描いた！"

LLMの推論 →
「イラスト？クリエイター？」
→ Instagram検索（作品確認）
→ Portfolio検索（実績確認）
→ pixiv検索（活動歴）

結果: "プロイラストレーター、Instagram 5万フォロワー"
```

### ケース3: ビジネス系アカウント

```
X投稿: "起業して3年目の学び"

LLMの推論 →
「起業家？」
→ LinkedIn検索（会社情報）
→ メディア検索（インタビュー）
→ ブログ検索（起業ストーリー）

結果: "スタートアップCEO、TechCrunch掲載"
```

## ⚙️ 設定オプション

### マルチプラットフォーム分析（推奨：ON）

```
☑ マルチプラットフォーム分析

効果:
- ペルソナ精度: +50%
- 処理時間: +5-10秒
- コスト: +1 API呼び出し
```

**おすすめ**: 初回分析時は必ずON

### Web検索（議論時）

```
☐ Web検索を有効化

効果:
- 最新情報を取得
- トピックに関する最新動向を反映
- 処理時間: +3-5秒
```

**おすすめ**: 最新トピック（ニュース、技術動向）ならON

### 会話履歴

```
☐ 会話履歴を保持

効果:
- 継続的な対話
- 前回の議論を参照
- コンテキスト維持
```

**おすすめ**: 複数ターンの深い議論ならON

## 🎊 まとめ

### なぜこれがAIエージェントなのか？

1. **🌐 自律的な環境観察**
   - X投稿を取得
   - **LLMが自分で判断してWeb検索**
   - 複数プラットフォームを調査

2. **🧠 高度な推論**
   - マルチソースのデータ統合
   - コンテキストを理解
   - 適切な検索クエリを生成

3. **💬 状態管理**
   - 会話履歴を保持
   - 継続的な対話が可能

4. **🎯 意思決定**
   - どの投稿を引用するか判断
   - どの情報を重視するか決定

5. **🔧 複数ツールの統合使用**
   - X API
   - Grok Live Search
   - Grok LLM
   - sentence-transformers

**これは間違いなくAIエージェントです！** 🤖✨

---

**バージョン**: MVP 2.1  
**実装日**: 2025年10月16日  
**ステータス**: ✅ 完全実装

